function r(t,e,i,s,a,u,p,v){var l=typeof t=="function"?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),s&&(l.functional=!0),u&&(l._scopeId="data-v-"+u);var o;if(p?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),a&&a.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(p)},l._ssrRegister=o):a&&(o=v?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(l.functional){l._injectStyles=o;var f=l.render;l.render=function(m,c){return o.call(c),f(m,c)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,o):[o]}return{exports:t,options:l}}const h={props:{condition:{type:Object,required:!0},field:{type:Object,required:!0}},methods:{getDateValue(){const t=this.condition.value;if(!t||typeof t=="string")return{selectedOption:"TODAY",offset:1,manualDate:""};if(t.type==="relative"){if(t.value)return{selectedOption:t.value,offset:1,manualDate:""};if(t.base){const e=t.offset>=0?"PLUS":"MINUS";return{selectedOption:`${t.base}_${e}_${t.unit.toUpperCase()}`,offset:Math.abs(t.offset),manualDate:""}}}else if(t.type==="manual")return{selectedOption:"OTHER",offset:1,manualDate:t.value};return{selectedOption:"TODAY",offset:1,manualDate:""}},getDateValueOptions(){return[{value:"TODAY",label:this.__("Today")},{value:"TOMORROW",label:this.__("Tomorrow")},{value:"YESTERDAY",label:this.__("Yesterday")},{value:"TODAY_PLUS_DAYS",label:this.__("Today + X days")},{value:"TODAY_PLUS_WEEKS",label:this.__("Today + X weeks")},{value:"TODAY_PLUS_MONTHS",label:this.__("Today + X months")},{value:"TODAY_PLUS_YEARS",label:this.__("Today + X years")},{value:"TODAY_MINUS_DAYS",label:this.__("Today - X days")},{value:"TODAY_MINUS_WEEKS",label:this.__("Today - X weeks")},{value:"TODAY_MINUS_MONTHS",label:this.__("Today - X months")},{value:"TODAY_MINUS_YEARS",label:this.__("Today - X years")},{value:"OTHER",label:this.__("Other...")}]},needsOffsetInput(t){return["TODAY_PLUS_DAYS","TODAY_PLUS_WEEKS","TODAY_PLUS_MONTHS","TODAY_PLUS_YEARS","TODAY_MINUS_DAYS","TODAY_MINUS_WEEKS","TODAY_MINUS_MONTHS","TODAY_MINUS_YEARS"].includes(t)},getOffsetLabel(t){return{TODAY_PLUS_DAYS:this.__("Days"),TODAY_MINUS_DAYS:this.__("Days"),TODAY_PLUS_WEEKS:this.__("Weeks"),TODAY_MINUS_WEEKS:this.__("Weeks"),TODAY_PLUS_MONTHS:this.__("Months"),TODAY_MINUS_MONTHS:this.__("Months"),TODAY_PLUS_YEARS:this.__("Years"),TODAY_MINUS_YEARS:this.__("Years")}[t]||""},onDateOptionChange(t){if(["TODAY","TOMORROW","YESTERDAY"].includes(t))this.$emit("update-value",{type:"relative",value:t});else if(this.needsOffsetInput(t)){const e=t.split("_"),i=e[0],s=e[1],a=e[2].toLowerCase();this.$emit("update-value",{type:"relative",base:i,offset:s==="MINUS"?-1:1,unit:a})}else t==="OTHER"&&this.$emit("update-value",{type:"manual",value:""})},updateDateOffset(t){const e=this.condition.value;if(e.type==="relative"&&e.base){const i=e.offset>=0?1:-1;this.$emit("update-value",{...e,offset:i*Math.abs(parseInt(t)||1)})}},updateManualDate(t){this.$emit("update-value",{type:"manual",value:t})}}};var b=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex items-center space-x-2 flex-1"},[i("v-select",{staticClass:"flex-1",attrs:{value:e.getDateValue().selectedOption,options:e.getDateValueOptions(),reduce:s=>s.value,label:"label",placeholder:e.__("Select date option")},on:{input:e.onDateOptionChange}}),e.needsOffsetInput(e.getDateValue().selectedOption)?[i("input",{staticClass:"input-text w-20",attrs:{type:"number",placeholder:1,min:"1"},domProps:{value:e.getDateValue().offset},on:{input:function(s){return e.updateDateOffset(s.target.value)}}}),i("span",{staticClass:"text-sm font-medium text-gray-600"},[e._v(" "+e._s(e.getOffsetLabel(e.getDateValue().selectedOption))+" ")])]:e._e(),e.getDateValue().selectedOption==="OTHER"?i("input",{staticClass:"input-text flex-1",attrs:{type:"date"},domProps:{value:e.getDateValue().manualDate},on:{input:function(s){return e.updateManualDate(s.target.value)}}}):e._e()],2)},y=[],g=r(h,b,y,!1,null,null,null,null);const O=g.exports,S={props:{condition:{type:Object,required:!0},field:{type:Object,required:!0}},computed:{isMultiSelect(){var t;return((t=this.field)==null?void 0:t.type)==="select"&&["IN","NOT IN"].includes(this.condition.operator)}}};var T=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex-1 min-w-0"},[e.isMultiSelect?i("v-select",{attrs:{value:e.condition.value,options:e.field.options||[],reduce:s=>s.value,label:"label",multiple:"",placeholder:e.__("Select Values")},on:{input:function(s){return e.$emit("update-value",s)}}}):i("v-select",{attrs:{value:e.condition.value,options:e.field.options||[],reduce:s=>s.value,label:"label",placeholder:e.__("Select Value")},on:{input:function(s){return e.$emit("update-value",s)}}})],1)},D=[],x=r(S,T,D,!1,null,null,null,null);const C=x.exports,I={props:{condition:{type:Object,required:!0},field:{type:Object,required:!0}},methods:{getBetweenValue(){const t=this.condition.value;return!t||typeof t=="string"?{min:"",max:""}:Array.isArray(t)?{min:t[0]||"",max:t[1]||""}:t},updateMin(t){const e=this.getBetweenValue();this.$emit("update-value",[t,e.max])},updateMax(t){const e=this.getBetweenValue();this.$emit("update-value",[e.min,t])}}};var A=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex items-center space-x-2 flex-1"},[i("input",{staticClass:"input-text flex-1",attrs:{type:"text",placeholder:e.__("Min value")},domProps:{value:e.getBetweenValue().min},on:{input:function(s){return e.updateMin(s.target.value)}}}),i("span",[e._v(e._s(e.__("and")))]),i("input",{staticClass:"input-text flex-1",attrs:{type:"text",placeholder:e.__("Max value")},domProps:{value:e.getBetweenValue().max},on:{input:function(s){return e.updateMax(s.target.value)}}})])},$=[],N=r(I,A,$,!1,null,null,null,null);const V=N.exports,E={props:{condition:{type:Object,required:!0},field:{type:Object,required:!0}}};var w=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex items-center space-x-2 flex-1"},[i("input",{staticClass:"input-text flex-1",attrs:{type:"number",placeholder:e.__("Number of days"),min:"1"},domProps:{value:e.condition.value},on:{input:function(s){e.$emit("update-value",parseInt(s.target.value)||1)}}}),i("span",[e._v(e._s(e.__("days")))])])},F=[],Y=r(E,w,F,!1,null,null,null,null);const L=Y.exports,M={props:{condition:{type:Object,required:!0},field:{type:Object,required:!0}}};var U=function(){var e=this,i=e._self._c;return i("input",{staticClass:"input-text flex-1",attrs:{type:"text",placeholder:e.__("Enter value")},domProps:{value:e.condition.value},on:{input:function(s){return e.$emit("update-value",s.target.value)}}})},k=[],R=r(M,U,k,!1,null,null,null,null);const j=R.exports,_={methods:{getField(t){return this.fields.find(e=>e.value===t)},getFieldOperators(t){return this.operators[t]||this.operators.text},getFieldOptions(t){const e=this.fields.find(i=>i.value===t);return(e==null?void 0:e.options)||[]},isDateField(t){const e=this.fields.find(i=>i.value===t);return(e==null?void 0:e.type)==="date"},isMultiSelectVisible(t){const e=this.fields.find(i=>i.value===(t==null?void 0:t.attribute));return(e==null?void 0:e.type)==="select"&&["IN","NOT IN"].includes(t==null?void 0:t.operator)},isSingleSelectVisible(t){const e=this.fields.find(i=>i.value===(t==null?void 0:t.attribute));return(e==null?void 0:e.type)==="select"&&!["IN","NOT IN"].includes(t==null?void 0:t.operator)},needsValueInput(t){return!["IS_NULL","IS_NOT_NULL","THIS_WEEK","THIS_MONTH","THIS_YEAR"].includes(t)},needsBetweenInput(t){return["BETWEEN","NOT_BETWEEN"].includes(t)},needsDaysInput(t){return["LAST_X_DAYS","NEXT_X_DAYS"].includes(t)},getOperatorsForType(t){var i;const e=this.fields.find(s=>s.value===t);return e?((i=this.operators)==null?void 0:i[e.type])||[]:[]},initializeGroups(){var t,e;return(e=(t=this.value)==null?void 0:t.groups)!=null&&e.length?this.value.groups:[{conjunction:"AND",conditions:[]}]}}},q={components:{DateValueInput:O,SelectValueInput:C,BetweenValueInput:V,DaysValueInput:L,TextValueInput:j},mixins:[_],props:{condition:{type:Object,required:!0},conditionIndex:{type:Number,required:!0},groupIndex:{type:Number,required:!0},fields:{type:Array,required:!0},operators:{type:Object,required:!0}},methods:{getValueInputComponent(){return this.isMultiSelectVisible(this.condition)||this.isSingleSelectVisible(this.condition)?"SelectValueInput":this.needsBetweenInput(this.condition.operator)?"BetweenValueInput":this.needsDaysInput(this.condition.operator)?"DaysValueInput":this.isDateField(this.condition.attribute)?"DateValueInput":"TextValueInput"},getCurrentField(){return this.fields.find(t=>t.value===this.condition.attribute)},getOperatorsForType(t){const e=this.getCurrentField();return e&&e.operators?e.operators.map(i=>({value:i,label:this.getOperatorLabel(i)})):e?this.operators[e.type]||this.operators.text:this.operators.text},getOperatorLabel(t){const i=[...this.operators.text,...this.operators.select,...this.operators.number,...this.operators.date].find(s=>s.value===t);return i?i.label:t},updateAttribute(t){var i;const e={...this.condition,attribute:t,operator:((i=this.getOperatorsForType(t)[0])==null?void 0:i.value)||"=",value:this.getDefaultValueForField(t)};this.$emit("update-condition",this.conditionIndex,e)},updateOperator(t){const e={...this.condition,operator:t,value:this.getDefaultValueForOperator(t)};this.$emit("update-condition",this.conditionIndex,e)},updateValue(t){const e={...this.condition,value:t};this.$emit("update-condition",this.conditionIndex,e)},getDefaultValueForField(t){const e=this.fields.find(i=>i.value===t);return(e==null?void 0:e.type)==="date"?{type:"relative",value:"TODAY"}:""},getDefaultValueForOperator(t){return this.needsBetweenInput(t)?{min:"",max:""}:this.needsValueInput(t)?this.condition.value:null}}};var G=function(){var e=this,i=e._self._c;return i("div",{staticClass:"flex items-center space-x-4 p-3 rounded-md"},[i("v-select",{staticClass:"w-1/3",attrs:{value:e.condition.attribute,options:e.fields,reduce:s=>s.value,label:"label",placeholder:e.__("Select Field")},on:{input:e.updateAttribute}}),i("v-select",{staticClass:"w-1/4",attrs:{value:e.condition.operator,options:e.getOperatorsForType(e.condition.attribute),reduce:s=>s.value,label:"label",placeholder:e.__("Select Operator")},on:{input:e.updateOperator}}),e.needsValueInput(e.condition.operator)?[i(e.getValueInputComponent(),{tag:"component",attrs:{condition:e.condition,field:e.getCurrentField()},on:{"update-value":e.updateValue}})]:e._e(),i("button",{staticClass:"btn-danger",attrs:{title:"Remove condition"},on:{click:function(s){return e.$emit("remove-condition",e.conditionIndex)}}},[e._v(" × ")])],2)},B=[],H=r(q,G,B,!1,null,null,null,null);const P=H.exports,W={components:{QueryCondition:P},props:{group:{type:Object,required:!0},groupIndex:{type:Number,required:!0},fields:{type:Array,required:!0},operators:{type:Object,required:!0},canMoveUp:{type:Boolean,default:!1},canMoveDown:{type:Boolean,default:!1},canRemove:{type:Boolean,default:!0}},data(){return{logicalOperators:["AND","OR"]}},methods:{updateConjunction(t){const e={...this.group,conjunction:t};this.$emit("update-group",this.groupIndex,e)},updateCondition(t,e){this.$emit("update-condition",this.groupIndex,t,e)},removeCondition(t){this.$emit("remove-condition",this.groupIndex,t)}}};var X=function(){var e=this,i=e._self._c;return i("div",{staticClass:"border border-gray-300 rounded-lg p-4"},[i("div",{staticClass:"flex items-center justify-between mb-4 pb-2 border-b border-gray-200"},[i("div",{staticClass:"flex items-center space-x-4"},[i("h3",{staticClass:"text-base font-bold"},[e._v(e._s(e.__("Group"))+" "+e._s(e.groupIndex+1))]),i("v-select",{staticClass:"w-32",attrs:{value:e.group.conjunction,options:e.logicalOperators},on:{input:e.updateConjunction}})],1),i("div",{staticClass:"flex items-center space-x-2"},[i("button",{staticClass:"btn",on:{click:function(s){return e.$emit("add-condition",e.groupIndex)}}},[e._v(" "+e._s(e.__("Add Condition"))+" ")]),i("div",{staticClass:"flex items-center space-x-1"},[e.canMoveUp?i("button",{staticClass:"btn p-2",attrs:{title:e.__("Move group up")},on:{click:function(s){return e.$emit("move-group-up",e.groupIndex)}}},[e._v(" ↑ ")]):e._e(),e.canMoveDown?i("button",{staticClass:"btn p-2",attrs:{title:e.__("Move group down")},on:{click:function(s){return e.$emit("move-group-down",e.groupIndex)}}},[e._v(" ↓ ")]):e._e()]),e.canRemove?i("button",{staticClass:"btn-danger",on:{click:function(s){return e.$emit("remove-group",e.groupIndex)}}},[e._v(" "+e._s(e.__("Remove Group"))+" ")]):e._e()])]),i("div",{staticClass:"space-y-3"},e._l(e.group.conditions,function(s,a){return i("query-condition",{key:a,attrs:{condition:s,"condition-index":a,"group-index":e.groupIndex,fields:e.fields,operators:e.operators},on:{"update-condition":e.updateCondition,"remove-condition":e.removeCondition}})}),1)])},z=[],K=r(W,X,z,!1,null,null,null,null);const Q=K.exports;const J={components:{QueryGroup:Q},mixins:[Fieldtype,_],props:{fields:{type:Array,required:!0,validator:t=>t.length===0?!0:t[0].label&&t[0].options?t.every(e=>"label"in e&&"options"in e&&e.options.every(i=>"label"in i&&"value"in i&&"type"in i)):t.every(e=>"label"in e&&"value"in e&&"type"in e)},sortFields:{type:Array,required:!0,validator:t=>t.every(e=>"label"in e&&"value"in e&&"type"in e)},defaultSortField:{type:String,default:""},defaultSortDirection:{type:String,default:"desc"},defaultBuilderTemplate:{type:String,default:""},builderTemplates:{type:Array,default:[]},operators:{type:Object,default:()=>({text:[{value:"=",label:__("Is exactly")},{value:"!=",label:__("Is not")},{value:"LIKE",label:__("Contains")},{value:"NOT LIKE",label:__("Does not contain")},{value:"STARTS_WITH",label:__("Starts with")},{value:"ENDS_WITH",label:__("Ends with")},{value:"IS_NULL",label:__("Is empty")},{value:"IS_NOT_NULL",label:__("Is not empty")}],select:[{value:"=",label:__("Is")},{value:"!=",label:__("Is not")},{value:"IN",label:__("Is any of")},{value:"NOT IN",label:__("Is none of")},{value:"IS_NULL",label:__("Nothing selected")},{value:"IS_NOT_NULL",label:__("Has selection")}],number:[{value:"=",label:__("Equals")},{value:"!=",label:__("Does not equal")},{value:">",label:__("Greater than")},{value:"<",label:__("Less than")},{value:">=",label:__("Greater than or equal to")},{value:"<=",label:__("Less than or equal to")},{value:"BETWEEN",label:__("Is between")},{value:"NOT_BETWEEN",label:__("Is not between")},{value:"IS_NULL",label:__("Is empty")},{value:"IS_NOT_NULL",label:__("Is not empty")}],date:[{value:"=",label:__("Is on")},{value:"!=",label:__("Is not on")},{value:">",label:__("Is after")},{value:"<",label:__("Is before")},{value:">=",label:__("Is on or after")},{value:"<=",label:__("Is on or before")},{value:"BETWEEN",label:__("Is between")},{value:"NOT_BETWEEN",label:__("Is not between")},{value:"LAST_X_DAYS",label:__("In the last days")},{value:"NEXT_X_DAYS",label:__("In the next days")},{value:"THIS_WEEK",label:__("This week")},{value:"THIS_MONTH",label:__("This month")},{value:"THIS_YEAR",label:__("This year")},{value:"IS_NULL",label:__("No date set")},{value:"IS_NOT_NULL",label:__("Has date")}]})},defaultLimit:{type:Number,default:100},showLimit:{type:Boolean,default:!0}},data(){return{groups:[],builderTemplate:"",limit:100,globalConjunction:"AND",logicalOperators:["AND","OR"],sortField:"",sortDirection:"",sortDirections:["ASC","DESC"]}},computed:{flattenedFields(){var t;return(t=this.fields[0])!=null&&t.options?this.fields.flatMap(e=>e.options):this.fields}},methods:{initializeLimit(){var t;return(t=this.value)!=null&&t.limit?this.value.limit:this.defaultLimit},initializeSortField(){var t;return(t=this.value)!=null&&t.sortField?this.value.sortField:this.defaultSortField},initializeSortDirection(){var t;return(t=this.value)!=null&&t.sortDirection?this.value.sortDirection:this.defaultSortDirection},initializeBuilderTemplate(){var t;return(t=this.value)!=null&&t.builderTemplate?this.value.builderTemplate:this.defaultBuilderTemplate},addGroup(){this.groups.push({conjunction:"AND",conditions:[]}),this.updateValue()},insertGroupAt(t){const e={conjunction:"AND",conditions:[]};this.groups.splice(t,0,e),this.updateValue()},removeGroup(t){this.groups.splice(t,1),this.updateValue()},updateGroup(t,e){this.$set(this.groups,t,e),this.updateValue()},addConditionToGroup(t){const e=this.createDefaultCondition();this.groups[t].conditions.push(e),this.updateValue()},updateCondition(t,e,i){this.$set(this.groups[t].conditions,e,i),this.updateValue()},removeCondition(t,e){this.groups[t].conditions.splice(e,1),this.updateValue()},createDefaultCondition(){var s;const t=this.flattenedFields[0],e=((s=this.getOperatorsForType(t==null?void 0:t.value)[0])==null?void 0:s.value)||"=";let i="";return(t==null?void 0:t.type)==="date"&&(i={type:"relative",value:"TODAY"}),{attribute:(t==null?void 0:t.value)||"",operator:e,value:i}},moveGroupUp(t){if(t>0){const e=this.groups[t];this.$set(this.groups,t,this.groups[t-1]),this.$set(this.groups,t-1,e),this.updateValue()}},moveGroupDown(t){if(t<this.groups.length-1){const e=this.groups[t];this.$set(this.groups,t,this.groups[t+1]),this.$set(this.groups,t+1,e),this.updateValue()}},updateValue(){this.$emit("input",{groups:this.groups,globalConjunction:this.globalConjunction})},updateSettingValues(){this.value.limit=parseInt(this.limit)||this.defaultLimit,this.value.builderTemplate=this.builderTemplate||this.defaultBuilderTemplate,this.value.sortField=this.sortField||this.defaultSortField,this.value.sortDirection=this.sortDirection||this.defaultSortDirection}},mounted(){this.groups=this.initializeGroups(),this.limit=this.initializeLimit(),this.sortField=this.initializeSortField(),this.sortDirection=this.initializeSortDirection(),this.builderTemplate=this.initializeBuilderTemplate()}};var Z=function(){var e=this,i=e._self._c;return i("div",{staticClass:"query-builder max-w-4xl mx-auto"},[i("div",{staticClass:"flex items-center justify-between mb-4"},[i("div",{staticClass:"flex flex-col justify-between w-full space-x-4 gap-4"},[i("div",{staticClass:"flex gap-2"},[e.showLimit?i("div",{staticClass:"flex items-center space-x-2"},[i("label",{staticClass:"text-sm",attrs:{for:"limit"}},[e._v(e._s(e.__("Limit results")))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.limit,expression:"limit"}],staticClass:"input-text w-24",attrs:{type:"number",name:"limit",id:"limit",min:"1"},domProps:{value:e.limit},on:{input:[function(s){s.target.composing||(e.limit=s.target.value)},e.updateSettingValues]}})]):e._e(),e.builderTemplates?i("div",{staticClass:"flex items-center space-x-2"},[i("label",{staticClass:"text-sm",attrs:{for:"template"}},[e._v(e._s(e.__("Template")))]),i("v-select",{staticClass:"w-36",attrs:{name:"builderTemplate",options:e.builderTemplates,reduce:s=>s.value},on:{input:e.updateSettingValues},model:{value:e.builderTemplate,callback:function(s){e.builderTemplate=s},expression:"builderTemplate"}})],1):e._e()]),i("div",{staticClass:"flex gap-2"},[e.sortFields?i("div",{staticClass:"flex items-center space-x-2"},[i("label",{staticClass:"text-sm",attrs:{for:"template"}},[e._v(e._s(e.__("Sort")))]),i("v-select",{staticClass:"w-36",attrs:{name:"sortField",options:e.sortFields,reduce:s=>s.value},on:{input:e.updateSettingValues},model:{value:e.sortField,callback:function(s){e.sortField=s},expression:"sortField"}})],1):e._e(),e.sortFields?i("div",{staticClass:"flex items-center space-x-2"},[i("label",{staticClass:"text-sm",attrs:{for:"template"}},[e._v(e._s(e.__("Sort Direction")))]),i("v-select",{staticClass:"w-36",attrs:{name:"sortDirection",options:e.sortDirections},on:{input:e.updateSettingValues},model:{value:e.sortDirection,callback:function(s){e.sortDirection=s},expression:"sortDirection"}})],1):e._e()])]),i("button",{staticClass:"btn-primary self-start",on:{click:e.addGroup}},[e._v(e._s(e.__("Add Group")))])]),i("div",{staticClass:"space-y-6"},[e.groups.length>0?i("div",{staticClass:"flex justify-center"},[i("button",{staticClass:"insert-group-btn",attrs:{title:e.__("Insert group here")},on:{click:function(s){return e.insertGroupAt(0)}}},[i("svg",{staticClass:"w-4 h-4",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"}},[i("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"}})])])]):e._e(),e._l(e.groups,function(s,a){return[i("query-group",{key:`group-${a}`,attrs:{group:s,"group-index":a,fields:e.flattenedFields,operators:e.operators,"can-move-up":a>0,"can-move-down":a<e.groups.length-1,"can-remove":e.groups.length>1},on:{"update-group":e.updateGroup,"remove-group":e.removeGroup,"move-group-up":e.moveGroupUp,"move-group-down":e.moveGroupDown,"add-condition":e.addConditionToGroup,"update-condition":e.updateCondition,"remove-condition":e.removeCondition}}),a<e.groups.length?i("div",{key:`separator-${a}`,staticClass:"flex flex-col items-center space-y-2"},[i("button",{staticClass:"insert-group-btn",attrs:{title:e.__("Insert group here")},on:{click:function(u){return e.insertGroupAt(a+1)}}},[i("svg",{staticClass:"w-4 h-4",attrs:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"}},[i("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"}})])])]):e._e()]})],2),e.groups.length?e._e():i("div",{staticClass:"text-center py-8 bg-gray-50 rounded-lg"},[i("p",{staticClass:"text-gray-500 mb-4"},[e._v(e._s(e.__('No groups added yet. Click "Add Group" to start building your query.')))])]),e.groups.length>1?i("div",{staticClass:"mt-6 pt-4 border-t border-gray-200"},[i("div",{staticClass:"flex items-center space-x-4"},[i("label",{staticClass:"font-bold"},[e._v(e._s(e.__("Combine Groups with:")))]),i("v-select",{staticClass:"w-32",attrs:{options:e.logicalOperators},on:{input:e.updateValue},model:{value:e.globalConjunction,callback:function(s){e.globalConjunction=s},expression:"globalConjunction"}})],1)]):e._e()])},ee=[],te=r(J,Z,ee,!1,null,"9baf06fa",null,null);const ie=te.exports,se={components:{QueryBuilder:ie},mixins:[Fieldtype],data(){return{attributes:[],groupedFields:[],templates:[{label:"Slider",value:"slider"},{label:"Listing",value:"listing"}],fieldGroups:[{key:"attribute",label:"Attributes",prefix:"attribute."},{key:"stock",label:"Stock",prefix:"",fields:[{label:"Stock Status",value:"stock_status",type:"select",operators:["=","!="],options:[{label:"In Stock",value:"in_stock"},{label:"Out of Stock",value:"out_of_stock"}]}]}]}},methods:{async fetchAttributes(){try{const t=await this.$axios.get("/cp/rapidez/product-attributes");this.attributes=t.data.map(e=>({label:e.frontend_label?e.frontend_label+` (${e.code})`:e.code,value:`attribute.${e.code}`,type:this.mapAttributeType(e.input),options:this.mapAttributeOptions(e.options)})),this.buildGroupedFields()}catch(t){console.error("Error fetching attributes:",t)}},buildGroupedFields(){this.groupedFields=this.fieldGroups.map(t=>t.key==="attribute"?{label:t.label,options:this.attributes}:{label:t.label,options:t.fields.map(e=>({...e,value:t.prefix?`${t.prefix}${e.value}`:e.value}))})},mapAttributeType(t){return{text:"text",textarea:"text",select:"select",multiselect:"select",boolean:"select",price:"number",weight:"number",date:"date",datetime:"date",timestamp:"date"}[t]||"text"},mapAttributeOptions(t){return t.length?(typeof t=="object"&&!Array.isArray(t)&&(t=Object.values(t)),t.map(e=>({label:e.store_value||e.option_id,value:e.option_id}))):[]}},mounted(){this.fetchAttributes()}};var ae=function(){var s;var e=this,i=e._self._c;return i("query-builder",{attrs:{fields:e.groupedFields,"sort-fields":e.attributes,"default-sort-field":(s=e.attributes[0])==null?void 0:s.value,"default-limit":100,"show-limit":!0,"builder-templates":e.templates,"default-builder-template":"slider"},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})},le=[],ne=r(se,ae,le,!1,null,null,null,null);const re=ne.exports;Statamic.booting(()=>{Statamic.component("product_query_builder-fieldtype",re)});
